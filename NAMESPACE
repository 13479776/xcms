useDynLib(xcms)

importFrom("utils", "capture.output")
import("methods")
importFrom("ProtGenerics", "peaks")
importFrom("BiocGenerics", "updateObject", "fileName")
import("Biobase")
importFrom("graphics", "plot", "image", "boxplot")
importFrom("mzR", "peaks", "close", "openMSfile", "header")
importFrom("lattice", "levelplot", "panel.rect", "panel.levelplot")
importFrom("plyr", "rbind.fill")
import("RColorBrewer")
import("BiocParallel")

## import("S4Vectors")
importClassesFrom("S4Vectors", "Rle", "DataFrame")
importFrom("S4Vectors", "split", "Rle", "DataFrame")
importMethodsFrom("S4Vectors", "as.matrix")

## Additional imports proposed by R CMD check:
importFrom("graphics", "abline", "barplot", "close.screen", "hist",
           "identify", "layout", "legend", "lines", "par", "plot.new",
           "plot.window", "points", "screen", "split.screen",
           "strwidth", "text", "title")
importFrom("grDevices", "col2rgb", "colorRampPalette", "dev.cur",
           "dev.list", "dev.off", "dev.set", "palette", "pdf", "png",
           "rainbow", "rgb", "terrain.colors")
importFrom("stats", "aov", "approx", "convolve", "cor", "deriv3",
           "dist", "fft", "fitted", "lm", "loess", "lsfit", "median",
           "na.omit", "nextn", "nls", "predict", "pt", "quantile",
           "runmed", "sd", "stepfun", "weighted.mean", "density")
importFrom("utils", "flush.console", "head", "object.size",
           "packageVersion", "read.csv", "tail", "write.csv",
           "write.table")

## New imports from packages moved from Suggests to Imports:
importFrom("multtest", "mt.teststat")
importFrom("RANN", "nn2")
importFrom("MassSpecWavelet", "peakDetectionCWT", "tuneInPeakInfo")

## MSnbase:
importClassesFrom("MSnbase", "MSnExp", "pSet", "OnDiskMSnExp")
importMethodsFrom("MSnbase", "intensity", "mz", "rtime", "fileNames", "fromFile",
                  "filterFile", "filterMsLevel", "msLevel", "scanIndex",
                  "spectra", "impute", "isCentroided", "polarity", "[", "bin",
                  "clean", "featureNames", "filterAcquisitionNum", "filterMz",
                  "filterRt", "normalize", "pickPeaks", "removePeaks",
                  "removeReporters", "smooth", "trimMz")
importFrom("MSnbase", "as.data.frame.Spectrum")

export(
    "etg",
    "medianFilter",
    "plotQC",
    "retexp",
    "specNoise",
    "specPeaks",
    "SSgauss",
    "msn2xcmsRaw",
    "verify.mzQuantML",
    "xcmsRaw",
    "xcmsSet",
    "xcmsFragments",
    "xcmsPapply"
)

S3method(plot, xcmsEIC)

S3method(split, xcmsSet)
S3method(c, xcmsSet)

S3method(split, xcmsRaw)

exportClasses(
    "xcmsEIC",
    "xcmsPeaks",
    "xcmsRaw",
    "xcmsSet",
    "xcmsFragments",
    "xcmsSource",
    "xcmsFileSource"
)

exportMethods(
    "[",
    "$",
    "absent",
    "AutoLockMass",
    "calibrate",
    "collect",
    "deepCopy",
    "filepaths",
    "filepaths<-",
    "diffreport",
    "findMZ",
    "findneutral",
    "fillPeaks",
    "fillPeaks.MSW",
    "fillPeaks.chrom",
    "findPeaks.centWave",
    "findPeaks.addPredictedIsotopeFeatures",
    "findPeaks.centWaveWithPredictedIsotopeROIs",
    "findPeaks.massifquant",
    "findPeaks.matchedFilter",
    "findPeaks.MSW",
    "findPeaks",
    "getEIC",
    "getPeaks",
    "getScan",
    "getMsnScan",
    "getSpec",
    "getXcmsRaw",
    "group",
    "group.density",
    "group.mzClust",
    "group.nearest",
    "groupidx",
    "groupidx<-",
    "groupnames",
    "groups",
    "groups<-",
    "groupval",
    "image",
    "levelplot",
    "mslevel",
    "mzrange",
    "peaks",
    "peaks<-",
    "peakTable",
    "phenoData",
    "phenoData<-",
    "plotChrom",
    "plotEIC",
    "plotPeaks",
    "plotRaw",
    "plotrt",
    "plotScan",
    "plotSpec",
    "plotSurf",
    "plotTIC",
    "plotTree",
    "present",
    "profinfo",
    "profinfo<-",
    "profMat",
    "profMedFilt",
    "profMethod",
    "profMethod<-",
    "profMz",
    "profRange",
    "profStep",
    "profStep<-",
    "progressCallback",
    "progressCallback<-",
    "rawEIC",
    "rawMat",
    "retcor",
    "retcor.peakgroups",
    "retcor.obiwarp",
    "revMz",
    "rtrange",
    "sampclass",
    "sampclass<-",
    "sampnames",
    "sampnames<-",
    "scanrange",
    "specDist",
    "specDist.cosine",
    "specDist.meanMZmatch",
    "specDist.peakCount",
    "show",
    "sortMz",
    "stitch",
    "updateObject",
    "write.cdf",
    "write.mzdata",
    "write.mzQuantML",
    "xcmsSource",
    "loadRaw"
)

## New functions
export(
    "binYonX",
    "breaks_on_binSize",
    "breaks_on_nBins",
    "do_detectFeatures_centWave",
    "do_detectFeatures_massifquant",
    "do_detectFeatures_matchedFilter",
    "do_detectFeatures_MSW",
    "do_detectFeatures_centWaveWithPredIsoROIs",
    "do_detectFeatures_addPredIsoROIs",
    "imputeLinInterpol",
    "useOriginalCode",
    "setAs",
    "do_groupFeatures_density",
    "do_groupFeatures_mzClust",
    "do_groupFeatures_nearest",
    "do_adjustRtime_featureGroups"
)

## New analysis methods
exportMethods(
    "showError",
    "detectFeatures",
    "groupFeatures"
)

## New Param classes
exportClasses(
    "CentWaveParam",
    "MatchedFilterParam",
    "MassifquantParam",
    "MSWParam",
    "CentWavePredIsoParam",
    "FeatureDensityParam",
    "MzClustParam",
    "NearestFeaturesParam",
    "FeatureGroupsParam"
)
## Param methods
exportMethods(
    "ppm",
    "ppm<-",
    "peakwidth",
    "peakwidth<-",
    "snthresh",
    "snthresh<-",
    "prefilter",
    "prefilter<-",
    "mzCenterFun",
    "mzCenterFun<-",
    "integrate",
    "integrate<-",
    "mzdiff",
    "mzdiff<-",
    "fitgauss",
    "fitgauss<-",
    "noise",
    "noise<-",
    "verboseColumns",
    "verboseColumns<-",
    "roiList",
    "roiList<-",
    "firstBaselineCheck",
    "firstBaselineCheck<-",
    "roiScales",
    "roiScales",
    ## MatchedFilter
    "binSize",
    "binSize<-",
    "impute",
    "impute<-",
    "baseValue",
    "baseValue<-",
    "distance",
    "distance<-",
    "fwhm",
    "fwhm<-",
    "sigma",
    "sigma<-",
    "max",
    "max<-",
    "steps",
    "steps<-",
    "index",
    "index<-",
    ## Massifquant
    "criticalValue",
    "criticalValue<-",
    "consecMissedLimit",
    "consecMissedLimit<-",
    "unions",
    "unions<-",
    "checkBack",
    "checkBack<-",
    "withWave",
    "withWave<-",
    ## MSWParam
    "scales",
    "scales<-",
    "nearbyPeak",
    "nearbyPeak<-",
    "peakScaleRange",
    "peakScaleRange<-",
    "ampTh",
    "ampTh<-",
    "minNoiseLevel",
    "minNoiseLevel<-",
    "ridgeLength",
    "ridgeLength<-",
    "peakThr",
    "peakThr<-",
    "tuneIn",
    "tuneIn<-",
    "addParams",
    "addParams<-",
    "snthreshIsoROIs",
    "snthreshIsoROIs<-",
    "maxCharge",
    "maxCharge<-",
    "maxIso",
    "maxIso<-",
    "mzIntervalExtension",
    "mzIntervalExtension<-",
    "polarity",
    "polarity<-",
    ## FeatureDensityParam
    "sampleGroups",
    "sampleGroups<-",
    "bw",
    "bw<-",
    "minFraction",
    "minFraction<-",
    "minSamples",
    "minSamples<-",
    "maxFeatures",
    "maxFeatures<-",
    ## MzClustParam
    "absMz",
    "absMz<-",
    ## NearestFeaturesParam
    "absRt",
    "absRt<-",
    "mzVsRtBalance",
    "mzVsRtBalance<-",
    "kNN",
    "kNN<-",
    "extraFeatures",
    "extraFeatures<-",
    "smooth",
    "smooth<-",
    "span",
    "span<-",
    "family",
    "family<-"
)
## Param class functions
export("CentWaveParam", "MatchedFilterParam", "MassifquantParam", "MSWParam",
       "CentWavePredIsoParam", "FeatureDensityParam", "MzClustParam",
       "NearestFeaturesParam", "FeatureGroupsParam")
## Param class methods.

## New Classes
exportClasses("XCMSnExp", "MsFeatureData", "ProcessHistory", "XProcessHistory")
## New methods for these classes
exportMethods("hasDetectedFeatures",
              "hasAlignedFeatures",
              "hasAdjustedRtime",
              "adjustedRtime",
              "adjustedRtime<-",
              "featureGroups",
              "featureGroups<-",
              "features",
              "features<-",
              "processHistory",
              "fileIndex",
              "processDate",
              "processInfo",
              "processParam",
              "processType",
              "bin",
              "clean",
              "filterAcquisitionNum",
              "filterFile",
              "filterMsLevel",
              "filterMz",
              "filterRt",
              "normalize",
              "pickPeaks",
              "removePeaks",
              "smooth",
              "dropAdjustedRtime",
              "dropFeatureGroups",
              "dropFeatures",
              "spectra",
              "rtime",
              "mz",
              "intensity"
              )
