% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/do_detectFeatures-functions.R
\name{do_detectFeatures_centWave}
\alias{do_detectFeatures_centWave}
\title{Feature detection using the centWave method}
\usage{
do_detectFeatures_centWave(mz, int, scantime, valsPerSpect, ppm = 25,
  peakwidth = c(20, 50), snthresh = 10, prefilter = c(3, 100),
  mzCenterFun = "wMean", integrate = 1, mzdiff = -0.001,
  fitgauss = FALSE, noise = 0, verboseColumns = FALSE, ROIs = list())
}
\arguments{
\item{mz}{Numeric vector with the individual m/z values from all scans/
spectra of one file/sample.}

\item{int}{Numeric vector with the individual intensity values from all
scans/spectra of one file/sample.}

\item{scantime}{Numeric vector of length equal to the number of
spectra/scans of the data representing the retention time of each scan.}

\item{valsPerSpect}{Numeric vector with the number of values for each
spectrum.}

\item{ppm}{Maximal tolerated m/z deviation in consecutive scans in parts
per million (ppm).}

\item{peakwidth}{Numeric of length 2 with the expected approximate
feature/peak width in chromatographic space. Given as a range (min, max)
in seconds.}

\item{snthresh}{Signal to noise ratio cutoff.}

\item{prefilter}{Numeric of length 2: \code{c(k, I)} specifying the prefilter
step for the first analysis step (ROI detection). Mass traces are only
retained if they contain at least \code{k} peaks with intensity >= \code{I}.}

\item{mzCenterFun}{Name of the function to calculate the m/z center of the
feature. Allowed are: \code{"wMean"}: intensity weighted mean of the feature's
m/z values, \code{"mean"}: mean of the feature's m/z values, \code{"apex"}:
use the m/z value at the peak apex, \code{"wMeanApex3"}: intensity weighted
mean of the m/z value at the peak apex and the m/z values left and right of
it and \code{"meanApex3"}: mean of the m/z value of the peak apex and the
m/z values left and right of it.}

\item{integrate}{Integration method. For \code{integrate = 1} peak limits
are found through descent on the mexican hat filtered data, for
\code{integrate = 2} the descent is done on the real data. The latter method
is more accurate but prone to noise, while the former is more robust, but
less exact.}

\item{mzdiff}{Numeric representing the minimum difference in m/z dimension
for peaks with overlapping retention times; can be negatove to allow overlap.}

\item{fitgauss}{Logical whether or not a Gaussian should be fitted to each
peak.}

\item{noise}{Numeric of length 1 allowing to set a minimum intensity required
for centroids to be considered in the first analysis step (centroids with
intensity \code{< noise} are omitted from ROI detection).}

\item{verboseColumns}{Logical whether additional feature meta data columns
should be returned.}

\item{ROIs}{An optional list of regions-of-interest (ROI) representing
detected mass traces. If ROIs are submitted the first analysis step is
omitted and feature detection is performed on the submitted ROIs. Each
ROI object in the list is expected to have the following slots specified:
\code{scmin} (start scan index), \code{scmax} (end scan index),
\code{mzmin} (minimum m/z), \code{mzmax} (maximum m/z), \code{length}
(number of scans), \code{intensity} (summed intensity).}
}
\value{
A matrix, each row representing an intentified feature, with columns:
\describe{
\item{mz}{Intensity weighted mean of m/z values of the feature across scans.}
\item{mzmin}{Minimum m/z of the feature.}
\item{mzmax}{Maximum m/z of the feature.}
\item{rt}{Retention time of the feature's midpoint.}
\item{rtmin}{Minimum retention time of the feature.}
\item{rtmax}{Maximum retention time of the feature.}
\item{into}{Integrated (original) intensity of the feature.}
\item{intb}{Per-feature baseline corrected integrated feature intensity.}
\item{maxo}{Maximum intensity of the feature.}
\item{sn}{Signal to noise ratio, defined as \code{(maxo - baseline)/sd},
\code{sd} being the standard deviation of local chromatographic noise.}
\item{egauss}{RMSE of Gaussian fit.}
}
Additional columns for \code{verboseColumns = TRUE}:
\describe{
\item{mu}{Gaussian parameter mu.}
\item{sigma}{Gaussian parameter sigma.}
\item{h}{Gaussian parameter h.}
\item{f}{Region number of the m/z ROI where the peak was localized.}
\item{dppm}{m/z deviation of mass trace across scanns in ppk.}
\item{scale}{Scale on which the feature was localized.}
\item{scpos}{Peak position found by wavelet analysis (scan number).}
\item{scmin}{Left peak limit found by wavelet analysis (scan number).}
\item{scmax}{Right peak limit found by wavelet analysis (scan numer).}
}
}
\description{
This function performs peak density and wavelet based feature
detection for high resulution LC/MS data in centroid mode [Tautenhahn 2008].
}
\details{
This algorithm is most suitable for high resolution
LC/\{TOF,OrbiTrap,FTICR\}-MS data in centroid mode. In the first phase the
method identifies \emph{regions of interest} (ROIs) representing mass traces
that are characterized as regions with less than \code{ppm} m/z deviation in
consecutive scans in the LC/MS map. These ROIs are then subsequently
analyzed using continuous wavelet transform (CWT) to locate chromatographic
peaks on different scales. The first analysis step is skipped, if regions
of interest are passed with the \code{ROIs} parameter.
}
\note{
The \emph{centWave} was designed to work on centroided mode, thus it
is expected that such data is presented to the function.

This function exposes core feature detection functionality of
the \emph{centWave} method. While this function can be called directly,
users will generally call the corresponding method for the data object
instead.
}
\examples{
## Load the test file
library(faahKO)
fs <- system.file('cdf/KO/ko15.CDF', package = "faahKO")
xr <- xcmsRaw(fs)

## Extracting the data from the xcmsRaw for do_detectFeatures_centWave
mzVals <- xr@env$mz
intVals <- xr@env$intensity
## Define the values per spectrum:
valsPerSpect <- diff(c(xr@scanindex, length(mzVals)))

res <- do_detectFeatures_centWave(mz = mzVals, int = intVals,
scantime = xr@scantime, valsPerSpect = valsPerSpect)
head(res)
}
\author{
Ralf Tautenhahn, Johannes Rainer
}
\references{
Ralf Tautenhahn, Christoph B\"{o}ttcher, and Steffen Neumann "Highly
sensitive feature detection for high resolution LC/MS" \emph{BMC Bioinformatics}
2008, 9:504
}
\seealso{
Other core feature detection functions: \code{\link{do_detectFeatures_MSW}},
  \code{\link{do_detectFeatures_matchedFilter}}
}

