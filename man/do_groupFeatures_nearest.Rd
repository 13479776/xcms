% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/do_groupFeatures-functions.R
\name{do_groupFeatures_nearest}
\alias{do_groupFeatures_nearest}
\title{Core API function for feature alignment using a nearest neighbor approach}
\usage{
do_groupFeatures_nearest(features, sampleGroups, mzVsRtBalance = 10,
  absMz = 0.2, absRt = 15, kNN = 10)
}
\arguments{
\item{features}{A \code{matrix} or \code{data.frame} with the mz values and
retention times of the identified features in all samples of an experiment.
Required columns are \code{"mz"}, \code{"rt"} and \code{"sample"}. The latter
should contain \code{numeric} values representing the index of the sample in
which the feature was found.}

\item{sampleGroups}{A vector of the same length than samples defining the
sample group assignments.}

\item{mzVsRtBalance}{numeric(1) representing the factor by which mz values are
multiplied before calculating the (euclician) distance between two features.}

\item{absMz}{numeric(1) maximum tolerated distance for mz values.}

\item{absRt}{numeric(1) maximum tolerated distance for rt values.}

\item{kNN}{numeric(1) representing the number of nearest neighbors to check.}
}
\value{
A \code{list} with elements \code{"featureGroups"} and
\code{"featureIndex"}. \code{"featureGroups"} is a \code{matrix}, each row
representing an aligned feature group and with columns:
\describe{
\item{"mzmed"}{median of the features' apex mz values.}
\item{"mzmin"}{smallest mz value of all features' apex within the feature
group.}
\item{"mzmax"}{largest mz value of all features' apex within the feature
group.}
\item{"rtmed"}{the median of the features' retention times.}
\item{"rtmin"}{the smallest retention time of the features in the group.}
\item{"rtmax"}{the largest retention time of the features in the group.}
\item{"npeaks"}{the total number of features assigned to the feature group.}
}
\code{"featureIndex"} is a \code{list} with the indices of all features in a
feature group in the \code{features} input matrix.
}
\description{
The \code{do_groupFeatures_nearest} function groups features
across samples by creating a master feature list and assigning corresponding
features from all samples to each feature group. The method is inspired by
the alignment algorithm of mzMine [Katajamaa 2006].
}
\references{
Katajamaa M, Miettinen J, Oresic M: MZmine: Toolbox for
processing and visualization of mass spectrometry based molecular profile
data. \emph{Bioinformatics} 2006, 22:634-636.
}
\seealso{
Other core feature alignment algorithms: \code{\link{do_groupFeatures_density}},
  \code{\link{do_groupFeatures_mzClust}}
}

