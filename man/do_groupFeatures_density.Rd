% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/do_groupFeatures-functions.R
\name{do_groupFeatures_density}
\alias{do_groupFeatures_density}
\title{Core API function for feature density based feature alignment}
\usage{
do_groupFeatures_density(features, sampleGroups, bw = 30, minFraction = 0.5,
  minSamples = 1, binSize = 0.25, maxFeatures = 50)
}
\arguments{
\item{features}{A \code{matrix} or \code{data.frame} with the mz values and
retention times of the identified features in all samples of an experiment.
Required columns are \code{"mz"}, \code{"rt"} and \code{"sample"}. The latter
should contain \code{numeric} values representing the index of the sample in
which the feature was found.}

\item{sampleGroups}{A vector of the same length than samples defining the
sample group assignments.}

\item{bw}{numeric(1) defining the bandwidth (standard deviation ot the
smoothing kernel) to be used. This argument is passed to the
\code{\link{density}} method.}

\item{minFraction}{numeric(1) defining the minimum fraction of samples in at
least one sample group in which the features have to be present to be
considered as a feature group.}

\item{minSamples}{numeric(1) with the minimum number of samples in at least
one sample group in which the features have to be detected to be considered
as a feature group.}

\item{binSize}{numeric(1) defining the size of the overlapping slices in mz
dimension.}

\item{maxFeatures}{numeric(1) with the maximum number of feature groups to
be identified in a single mz slice.}
}
\value{
A \code{list} with elements \code{"featureGroups"} and
\code{"featureIndex"}. \code{"featureGroups"} is a \code{matrix}, each row
representing an aligned feature group and with columns:
\describe{
\item{"mzmed"}{median of the features' apex mz values.}
\item{"mzmin"}{smallest mz value of all features' apex within the feature
group.}
\item{"mzmax"}{largest mz value of all features' apex within the feature
group.}
\item{"rtmed"}{the median of the features' retention times.}
\item{"rtmin"}{the smallest retention time of the features in the group.}
\item{"rtmax"}{the largest retention time of the features in the group.}
\item{"npeaks"}{the total number of features assigned to the feature group.
Note that this number can be larger than the total number of samples, since
multiple features from the same sample could be assigned to a group.}
}
\code{"featureIndex"} is a \code{list} with the indices of all features in a
feature group in the \code{features} input matrix.
}
\description{
The \code{do_groupFeatures_density} function performs feature
alignment based on the density (distribution) of features, found in different
samples, along the retention time axis in slices of overlapping mz ranges.
}
\details{
For overlapping slices along the mz dimension, the function
calculates the density distribution of identified features along the
retention time axis and groups features from the same or different samples
that are close to each other. See [Smith 2006] for more details.
}
\note{
The default settings might not be appropriate for all LC/GC-MS setups,
especially the \code{bw} and \code{binSize} parameter should be adjusted
accordingly.
}
\examples{
## Load the test data set
library(faahKO)
data(faahko)

## Extract the matrix with the identified features from the xcmsSet:
fts <- peaks(faahko)

## Perform the feature alignment with default settings:
res <- do_groupFeatures_density(fts, sampleGroups = sampclass(faahko))

## The feature groups:
head(res$featureGroups)

## The assignment of features from the input matrix to the feature groups
head(res$featureIndex)
}
\author{
Colin Smith, Johannes Rainer
}
\references{
Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
\emph{Anal. Chem.} 2006, 78:779-787.
}
\seealso{
Other core feature alignment algorithms: \code{\link{do_groupFeatures_mzClust}}
}

