% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/do_adjustRtime-functions.R
\name{do_adjustRtime_featureGroups}
\alias{do_adjustRtime_featureGroups}
\title{Align spectrum retention times across samples using feature groups
found in most samples}
\usage{
do_adjustRtime_featureGroups(features, featureIndex, rtime, minFraction = 0.9,
  extraFeatures = 1, smooth = c("loess", "linear"), span = 0.2,
  family = c("gaussian", "symmetric"))
}
\arguments{
\item{features}{a \code{matrix} or \code{data.frame} with the identified
features in the samples.}

\item{featureIndex}{a \code{list} of indices that provides the grouping
information of the features (across and within samples).}

\item{rtime}{A \code{list} of \code{numeric} vectors with the retention times
per file/sample.}

\item{minFraction}{numeric(1) between 0 and 1 defining the minimum required
fraction of samples in which features for the feature group were identified.
Feature groups passing this criteria will aligned across samples and retention
times of individual spectra will be adjusted based on this alignment. For
\code{minFraction = 1} the feature group has to contain features in all
samples of the experiment.}

\item{extraFeatures}{numeric(1) defining the maximal number of additional
features for all samples to be assigned to a feature group for retention time
correction. For a data set with 6 samples, \code{extraFeatures = 1} uses all
feature groups with a total feature count \code{<= 6 + 1}. The total feature
count is the total number of features being assigned to a feature group and
considers also multiple features within a sample being assigned to the group.}

\item{smooth}{character defining the function to be used, to interpolate
corrected retention times for all feature groups. Either \code{"loess"} or
\code{"linear"}.}

\item{span}{numeric(1) defining the degree of smoothing (if
\code{smooth = "loess"}). This parameter is passed to the internal call
to \code{\link{loess}}.}

\item{family}{character defining the method to be used for loess smoothing.
Allowed values are \code{"gaussian"} and \code{"symmetric"}.See
\code{\link{loess}} for more information.}
}
\value{
A \code{numeric} vector with the adjusted retention times.
}
\description{
The function performs retention time correction by assessing
the retention time deviation across all samples using feature groups containg
features present in most/all samples. The retention time deviation
for these feature groups in each sample is described by fitting either a
polynomial (\code{smooth = "loess"}) or a linear (\code{smooth = "linear"})
model to the data points. The models are subsequently used to adjust the
retention time for each spectrum in each sample.
}
\details{
The alignment bases on the presence of compounds that can be found
in all/most samples of an experiment. The retention times of individual
spectra are then adjusted based on the alignment of the feature groups
corresponding to these \emph{house keeping compounds}. The paraneters
\code{minFraction} and \code{extraFeatures} can be used to fine tune which
feature groups should be used for the alignment (i.e. which feature groups
most likely correspond to the above mentioned house keeping compounds).
}
\author{
Colin Smith, Johannes Rainer
}
\references{
Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
\emph{Anal. Chem.} 2006, 78:779-787.
}

